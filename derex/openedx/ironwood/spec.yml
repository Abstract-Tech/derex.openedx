builder:
  class: derex.builder.builders.BuildahBuilder

source:
  type: derex-relative
  path: wheels

copy:
  assets.py: /tmp
  entrypoint.sh: /entrypoint.sh
  wsgi.py: /tmp/
  base.py: /tmp/

config:
  cmd: gunicorn --name ${SERVICE_VARIANT} --bind=0.0.0.0:8000 --max-requests=1000 ${SERVICE_VARIANT}.wsgi:application
  entrypoint: '["/entrypoint.sh"]'
  workingdir: /openedx/edx-platform
  env:
    CONFIG_ROOT: /openedx/config
    PATH: /openedx/bin:${PATH}
    SERVICE_VARIANT: lms
    SETTINGS: derex.base

build_env:
  - TRANSIFEX_USERNAME
  - TRANSIFEX_PASSWORD

scripts:
  - install_openedx.sh
  - translations.sh
  - compile_assets.sh
  - install_custom.sh

dest: derex/openedx-ironwood
